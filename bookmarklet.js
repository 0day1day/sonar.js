javascript:(function()%7Bfunction get_path( url ) %7Bvar a %3D document.createElement('a')%3Ba.href %3D url%3Breturn a.port %2B a.pathname%3B%7Dfunction get_images() %7Bvar images %3D document.getElementsByTagName('img')%3Bvar srcList %3D %5B%5D%3Bfor(var i %3D 0%3B i < images.length%3B i%2B%2B) %7BsrcList.push( get_path( images%5Bi%5D.src ) )%3B%7Dreturn srcList%3B%7Dfunction get_css() %7Bvar css_links %3D document.getElementsByTagName('link')%3Bvar srcList %3D %5B%5D%3Bfor(var i %3D 0%3B i < css_links.length%3B i%2B%2B) %7Bif( css_links%5Bi%5D.rel %3D%3D%3D "stylesheet" ) %7BsrcList.push( get_path( css_links%5Bi%5D.href ) )%3B%7D%7Dreturn srcList%3B%7Dfunction generate_function( name ) %7Bvar template %3D decodeURI( "var%2520fingerprints%2520%3D%2520%255B%250A%2520%2520%2520%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520'name'%3A%2520%255BREPLACE_WITH_DEVICE_NAME%255D%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520'fingerprints'%3A%2520%255BREPLACE_WITH_FINGERPRINTS_ARRAY%255D%2C%250A%2520%2520%2520%2520%2520%2520%2520%2520'callback'%3A%2520function(%2520ip%2520)%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%2F%2F%2520Insert%2520exploit%2520here%250A%2520%2520%2520%2520%2520%2520%2520%2520%257D%2C%250A%2520%2520%2520%2520%257D%2C%250A%255D" )%3Btemplate %3D template.replace( '%5BREPLACE_WITH_DEVICE_NAME%5D'%2C JSON.stringify( name ) )%3Btemplate %3D template.replace( '%5BREPLACE_WITH_FINGERPRINTS_ARRAY%5D'%2C JSON.stringify( fingerprint() ) )%3Bconsole.log( template )%3B%7Dfunction fingerprint() %7Btmp %3D %5B%5D%3Btmp %3D tmp.concat( get_images() )%3Btmp %3D tmp.concat( get_css() )%3Breturn tmp%3B%7Dvar exploit_name %3D window.prompt( "Please enter the name of this device"%2C "" )%3Bcode %3D generate_function( exploit_name )%7D)()
